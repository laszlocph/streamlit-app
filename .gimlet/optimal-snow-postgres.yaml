app: postgres
env: optimal-snow
namespace: default
manifests: |
  ---
  apiVersion: source.toolkit.fluxcd.io/v1
  kind: HelmRepository
  metadata:
    name: postgres
    namespace: default
  spec:
    interval: 360m
    url: https://charts.bitnami.com/bitnami
  ---
  apiVersion: helm.toolkit.fluxcd.io/v2
  kind: HelmRelease
  metadata:
    name: postgres
    namespace: default
  spec:
    interval: 60m
    releaseName: postgres
    chart:
      spec:
        chart: postgresql
        version: 15.5.31
        sourceRef:
          kind: HelmRepository
          name: postgres
        interval: 10m
    values:
      fullnameOverride: postgres1
      primary:
        service:
          annotations:
            gimlet.io/git-repository: laszlocph/streamlit-app
            gimlet.io/git-sha: '{{ .SHA }}'
            gimlet.io/app: postgres
      auth:
        existingSecret: postgresql-credentials
      architecture: standalone
      tls:
        enabled: true
        autoGenerated: true
      persistence:
        enabled: true
        size: 8Gi
      persistentVolumeClaimRetentionPolicy:
        enabled: true
        whenScaled: Retain
        whenDeleted: Retain
  ---
  apiVersion: v1
  kind: Secret
  metadata:
    name: postgresql-credentials
    namespace: default
  type: Opaque
  stringData:
    postgres-password: super-secret-password
